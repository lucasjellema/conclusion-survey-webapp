{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Survey Schema",
  "description": "Schema for defining dynamic survey steps and questions",
  "type": "object",
  "required": ["title", "description", "steps"],
  "properties": {
    "title": {
      "type": "string",
      "description": "Title of the survey"
    },
    "description": {
      "type": "string",
      "description": "Description of the survey"
    },
    "steps": {
      "type": "array",
      "description": "Array of survey steps",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "title", "questions"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the step"
          },
          "title": {
            "type": "string",
            "description": "Title of the step"
          },
          "description": {
            "type": "string",
            "description": "Description of the step"
          },
          "questions": {
            "type": "array",
            "description": "Array of questions in this step",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["id", "type", "title"],
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Unique identifier for the question"
                },
                "type": {
                  "type": "string",
                  "enum": ["shortText", "longText", "radio", "checkbox", "likert", "rangeSlider", "matrix2d"],
                  "description": "Type of question"
                },
                "title": {
                  "type": "string",
                  "description": "Title of the question"
                },
                "description": {
                  "type": "string",
                  "description": "Description of the question"
                },
                "allowComment": {
                  "type": "boolean",
                  "default": false,
                  "description": "Whether to allow comments for this question"
                },
                "required": {
                  "type": "boolean",
                  "default": false,
                  "description": "Whether this question is required to be answered"
                },
                "options": {
                  "type": "array",
                  "description": "Options for radio, checkbox, or likert questions",
                  "items": {
                    "type": "object",
                    "required": ["value", "label"],
                    "properties": {
                      "value": {
                        "type": "string",
                        "description": "Value of the option"
                      },
                      "label": {
                        "type": "string",
                        "description": "Display label for the option"
                      }
                    }
                  }
                },
                "likertScale": {
                  "type": "object",
                  "description": "Scale definition for Likert questions",
                  "properties": {
                    "min": {
                      "type": "integer",
                      "default": 1,
                      "description": "Minimum value of the scale"
                    },
                    "max": {
                      "type": "integer",
                      "default": 5,
                      "description": "Maximum value of the scale"
                    },
                    "labels": {
                      "type": "object",
                      "description": "Labels for scale points",
                      "additionalProperties": {
                        "type": "string"
                      }
                    }
                  }
                },
                "rangeSlider": {
                  "type": "object",
                  "description": "Configuration for range slider questions",
                  "properties": {
                    "min": {
                      "type": "number",
                      "description": "Minimum value of the slider"
                    },
                    "max": {
                      "type": "number",
                      "description": "Maximum value of the slider"
                    },
                    "step": {
                      "type": "number",
                      "default": 1,
                      "description": "Step value for the slider"
                    },
                    "labels": {
                      "type": "object",
                      "description": "Labels for significant points on the slider",
                      "additionalProperties": {
                        "type": "string"
                      }
                    }
                  }
                },
                "matrix": {
                  "type": "object",
                  "description": "Configuration for 2D matrix questions",
                  "properties": {
                    "rows": {
                      "type": "array",
                      "description": "Row labels for the matrix",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Row identifier"
                          },
                          "label": {
                            "type": "string",
                            "description": "Row label"
                          }
                        }
                      }
                    },
                    "columns": {
                      "type": "array",
                      "description": "Column labels for the matrix",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Column identifier"
                          },
                          "label": {
                            "type": "string",
                            "description": "Column label"
                          }
                        }
                      }
                    },
                    "allowMultiple": {
                      "type": "boolean",
                      "default": false,
                      "description": "Whether multiple cells can be selected"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
